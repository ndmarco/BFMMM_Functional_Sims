# BFMMM_Functional_Sims
Simulation and Case Studies for functional mixed membership models (BFMMM). Each folder is labeled by the corresponding simulation or case study in the paper.
Each folder contains a run_script.R which will create simulated data, run MCMC, and save the posterior draws in a user-specified directory. In the run_script file, we use the function install_github() (devtools package) to install our package directly from [Github](https://github.com/ndmarco/BayesFMMM). We note that in order to compile the package using install_github(), you will need the GNU compiler collection (GCC) to compile the code. On Mac OS you will also need to install the Xcode developer tools. See [r-project](https://mac.r-project.org/tools/) to install the GNU Fortran compiler and for instructions on how to install the Xcode developer tools. On windows, you will need to install the RTools package from [r-project](https://cran.r-project.org/bin/windows/Rtools/). This [website](https://clanfear.github.io/CSSS508/docs/compiling.html)  can also be a helpful resource for compiling R packages on Mac or Windows. The R package also depends on the following R packages: Rcpp, RcppArmadillo, RcppDist, splines2 (>= 0.3.0), and testthat. A binary package for Mac OS is given in this repository (BayesFMMM_0.1.0.0.tgz). When running the run_script file, you will have to specify a directory and will need at least 25 Gb of free space. Once the run_script file has finished running, the Post_inference / Post_Processing scripts will allow you to conduct the posterior inference and obtain the plots used in the manuscript. Unfortunately, the data used in the case study cannot be shared, however, the scripts used to run it can also be found in this repository, under Case_Study_1 and Case_Study_2. The supplementary simulation study code for case study 1 is also contained in this repository. To run the supplemental simulation study (specifically the Post_Processing scripts), you will need a recent version of Python3 and will need to download the full package for openCV (`pip3 install opencv-contrib-python').

These simulation results and case studies results can be found in the following paper: 

Nicholas Marco, Damala Senturk, Shafali Jeste, Charlotte DiStefano, Abigail Dickinson, and Donatello Telesca. Functional mixed membership models. *arXiv preprint
arXiv:2206.12084*, 2022
